
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tokyo Ghoul: Awakening</title>
    <link rel="icon" type="image/x-icon" href="/assets/favicon/favicon.ico" />
    
    <!-- Primary Meta Tags -->
    <meta name="title" content="Tokyo Ghoul: Awakening | 東京喰種：覺醒" />
    <meta name="description" content="Unofficial Tokyo Ghoul Awakening tools. 非官方東京喰種Awakening工具。" />
    <meta name="keywords" content="Tokyo Ghoul, 東京喰種, Awakening, Database, Characters, Tools, Fan Project" />
    <meta name="author" content="Tokyo Ghoul: Awakening" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="English, Chinese" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tga.nossite.com/" />
    <meta property="og:title" content="Tokyo Ghoul: Awakening | 東京喰種：覺醒" />
    <meta property="og:description" content="Unofficial Tokyo Ghoul Awakening tools. 非官方東京喰種Awakening工具。" />
    <meta property="og:image" content="https://tga.nossite.com/assets/favicon/favicon.ico" />
    <meta property="og:image:alt" content="Tokyo Ghoul: Awakening" />
    <meta property="og:site_name" content="Tokyo Ghoul: Awakening" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:locale:alternate" content="zh_TW" />
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:url" content="https://tga.nossite.com/" />
    <meta name="twitter:title" content="Tokyo Ghoul: Awakening | 東京喰種：覺醒" />
    <meta name="twitter:description" content="Unofficial Tokyo Ghoul Awakening tools. 非官方東京喰種Awakening工具。" />
    <meta name="twitter:image" content="https://tga.nossite.com/assets/favicon/favicon.ico" />
    <meta name="twitter:image:alt" content="Tokyo Ghoul: Awakening" />
    
    <!-- Additional Meta Tags -->
    <meta name="theme-color" content="#ff0000" />
    <meta name="msapplication-TileColor" content="#ff0000" />
    <link rel="canonical" href="https://tga.nossite.com/" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&family=Shippori+Mincho+B1:wght@400;500;600;700;800&family=Nosifer&display=swap" rel="stylesheet">
    <script>
      // Apply theme before page renders to prevent flash of light mode
      (function() {
        try {
          const stored = localStorage.getItem('tga-theme');
          // If stored is 'true', use dark mode. If null (first visit), default to dark (true)
          const isDark = stored === 'true' || stored === null;
          if (isDark) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        } catch (e) {
          // Fallback: default to dark mode if localStorage is not available
          document.documentElement.classList.add('dark');
        }
      })();
    </script>
    <style>
      html {
        background-color: #f5f5f5;
        overflow-x: hidden;
        transition: background-color 0.3s, color 0.3s;
        font-family: 'Rajdhani', sans-serif;
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, auto !important;
      }

      html.dark {
        background-color: #18181b;
      }

      body {
        background-color: transparent;
        color: #1a1a1a;
        overflow-x: hidden;
        transition: background-color 0.3s, color 0.3s;
        font-family: 'Rajdhani', sans-serif;
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, auto !important;
      }

      html.dark body {
        color: #e5e5e5;
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-track {
        background: #e5e5e5; 
      }
      html.dark ::-webkit-scrollbar-track {
        background: #18181b;
      }
      
      ::-webkit-scrollbar-thumb {
        background: #999; 
        border-radius: 0px;
      }
      html.dark ::-webkit-scrollbar-thumb {
        background: #52525b;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #ff0000; 
      }
      
      /* Angled Shapes */
      .clip-angled {
        clip-path: polygon(
          20px 0, 100% 0, 
          100% calc(100% - 20px), calc(100% - 20px) 100%, 
          0 100%, 0 20px
        );
      }
      
      .clip-button {
        clip-path: polygon(
          12px 0, 100% 0, 
          100% calc(100% - 12px), calc(100% - 12px) 100%, 
          0 100%, 0 12px
        );
      }

      .text-glow {
        text-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
      }
      html.dark .text-glow {
        text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
      }
      
      /* Grid Overlay Utility */
      .bg-grid-overlay {
        background-size: 20px 20px;
        background-image: linear-gradient(to right, rgba(255, 0, 0, 0.1) 1px, transparent 1px),
                          linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 1px, transparent 1px);
      }
      
      /* Improved Readability Input */
      .input-ghoul-focus {
         transition: all 0.3s ease;
      }
      .input-ghoul-focus:focus {
         background-color: rgba(255, 0, 0, 0.05);
         box-shadow: 0 0 0 1px rgba(255, 0, 0, 0.3);
      }

      /* --- MAP SPECIFIC STYLES --- */
      :root {
        /* Light Mode Defaults (CCG/Laboratory Style) */
        --hex-stroke: #a1a1aa; /* Zinc 400 - Increased contrast */
        --hex-stroke-width: 1.5; /* Increased width */
        --hex-fill: #ffffff;   /* White */
        --hex-hover: rgba(239, 68, 68, 0.1);
        --label-scale: 1;
        
        /* Map SVG Elements */
        --label-bg-fill: rgba(255, 255, 255, 0.95);
        --label-text-fill: #18181b;
        --label-stroke: #ef4444;
        --map-bg: #ffffff; /* Pure white for better visibility */
        --grid-line-color: #e4e4e7; /* Zinc 200 */
      }

      html.dark {
        /* Dark Mode Overrides (Ghoul/Night Style) */
        --hex-stroke: #52525b; /* Zinc 600 - Increased contrast (Lighter grey on dark bg) */
        --hex-fill: rgba(24, 24, 27, 0.5);
        --hex-hover: rgba(220, 38, 38, 0.15);
        
        /* Map SVG Elements */
        --label-bg-fill: rgba(9, 9, 11, 0.95); /* Zinc 950 */
        --label-text-fill: #ffffff;
        --label-stroke: #ef4444;
        --map-bg: #18181b; /* Zinc 900 - Lighter than before for better visibility */
        --grid-line-color: #27272a; /* Zinc 800 */
      }
      
      .hex-group {
        pointer-events: painted;
      }

      .hex-polygon {
        fill: var(--hex-fill);
        stroke: var(--hex-stroke);
        stroke-width: var(--hex-stroke-width);
        stroke-linejoin: miter;
        stroke-miterlimit: 10;
        vector-effect: non-scaling-stroke;
        transition: fill 120ms ease, stroke-width 120ms ease, stroke 120ms ease;
      }

      .hex-group:hover .hex-polygon {
        fill: var(--hex-hover) !important;
        /* Border is now handled by the highlight overlay layer, so we keep this subtle or remove stroke change */
        stroke: #7f1d1d !important; 
        stroke-opacity: 0.5;
      }
      
      /* Disable hover effects during panning */
      .hex-map.panning .hex-group {
        pointer-events: none !important;
      }
      .hex-map.panning .hex-group:hover .hex-polygon {
        fill: var(--hex-fill) !important;
        stroke: var(--hex-stroke) !important;
      }

      .hex-mark {
        fill: transparent;
        stroke: transparent;
        pointer-events: none;
        transition: fill 120ms ease;
      }

      .hex-mark.marked {
        stroke-width: 2;
      }

      /* SVG Label Classes */
      .map-label-bg {
        fill: var(--label-bg-fill);
        stroke: var(--label-stroke);
        stroke-width: 1;
        rx: 4px;
        ry: 4px;
      }

      .map-label-text {
        fill: var(--label-text-fill);
        font-family: 'Rajdhani', sans-serif;
        font-weight: 700;
        font-size: 16px;
        text-anchor: middle;
        dominant-baseline: middle;
        pointer-events: none;
        text-shadow: 0 0 4px rgba(0,0,0,0.1);
      }
      html.dark .map-label-text {
         text-shadow: 0 0 4px rgba(0,0,0,0.5);
      }

      .hex-icon {
        pointer-events: none;
        opacity: 0.9;
        transition: opacity 200ms ease, transform 200ms ease;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
      }

      /* Custom Cursor Styles - 應用於所有元素 */
      *,
      *::before,
      *::after {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, auto !important;
      }
      
      /* 可點擊元素使用 pointer 游標 */
      a, 
      button, 
      [role="button"], 
      input[type="button"], 
      input[type="submit"], 
      input[type="reset"],
      [onclick],
      [style*="cursor: pointer"],
      .cursor-pointer {
        cursor: url('/assets/cursor/hand.png') 0 0, pointer !important;
      }
      
      /* 文字輸入元素使用文字游標 */
      input[type="text"], 
      input[type="email"], 
      input[type="password"], 
      input[type="search"],
      input[type="url"],
      input[type="tel"],
      input[type="number"],
      textarea, 
      select,
      [contenteditable="true"],
      [contenteditable=""] {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, text !important;
      }
      
      /* 拖拽相關游標 */
      svg.dragging,
      [draggable="true"]:active {
        cursor: url('/assets/cursor/hand.png') 0 0, grabbing !important;
      }
      
      svg:not(.dragging) {
        cursor: url('/assets/cursor/hand.png') 0 0, grab !important;
      }
      
      /* 禁用狀態 */
      :disabled,
      [disabled],
      [aria-disabled="true"] {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, not-allowed !important;
      }
      
      /* 等待/加載狀態 */
      [aria-busy="true"],
      .loading {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, wait !important;
      }
      
      /* 調整大小游標 */
      [style*="resize"] {
        cursor: url('/assets/cursor/hand.png') 0 0, nwse-resize !important;
      }
      
      /* 確保圖片和 SVG 也使用自定義游標 */
      img,
      svg,
      canvas,
      video {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, auto !important;
      }
      
      /* 確保所有互動元素在 hover 時也顯示正確游標 */
      a:hover,
      button:hover,
      [role="button"]:hover {
        cursor: url('/assets/cursor/hand.png') 0 0, pointer !important;
      }
      
      /* 強制覆蓋所有可能的游標樣式，包括內聯樣式 */
      [style*="cursor"] {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, auto !important;
      }
      
      /* 特別處理 SVG 元素的所有狀態 */
      svg,
      svg * {
        cursor: url('/assets/cursor/hand.png') 0 0, grab !important;
      }
      
      svg.dragging,
      svg.dragging * {
        cursor: url('/assets/cursor/hand.png') 0 0, grabbing !important;
      }
      
      /* 確保所有偽元素和動態添加的元素也使用自定義游標 */
      ::selection {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, auto !important;
      }
      
      /* 覆蓋可能的內聯樣式 */
      [style*="cursor: default"],
      [style*="cursor:auto"] {
        cursor: url('/assets/cursor/arrow.png') 0 0, url('/assets/cursor/hand.png') 0 0, auto !important;
      }
      
      [style*="cursor: pointer"],
      [style*="cursor:grab"] {
        cursor: url('/assets/cursor/hand.png') 0 0, pointer !important;
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.554.0",
    "react-markdown": "https://esm.sh/react-markdown@9?bundle",
    "react-dom": "https://aistudiocdn.com/react-dom@^19.2.0"
  }
}
</script>
</head>
  <body>
    <div id="root"></div>
  <script type="module" src="/index.tsx"></script>
  <script>
    // 強制設置自定義游標，確保始終顯示
    const cursorArrow = '/assets/cursor/arrow.png';
    const cursorHand = '/assets/cursor/hand.png';
    
    // 獲取當前鼠標下的元素並設置游標
    function getCursorForElement(element) {
      if (!element || element === document || element === document.documentElement) {
        return `url('${cursorArrow}') 0 0, url('${cursorHand}') 0 0, auto`;
      }
      
      const tagName = element.tagName?.toLowerCase();
      const isClickable = element.tagName === 'A' || 
                        element.tagName === 'BUTTON' || 
                        element.getAttribute('role') === 'button' ||
                        element.onclick !== null ||
                        element.classList?.contains('cursor-pointer') ||
                        element.closest('a, button, [role="button"]');
      
      const isInput = tagName === 'input' || tagName === 'textarea' || tagName === 'select' || 
                     element.contentEditable === 'true' ||
                     element.closest('input, textarea, select, [contenteditable]');
      
      if (isClickable) {
        return `url('${cursorHand}') 0 0, pointer`;
      } else if (isInput) {
        return `url('${cursorArrow}') 0 0, url('${cursorHand}') 0 0, text`;
      } else {
        return `url('${cursorArrow}') 0 0, url('${cursorHand}') 0 0, auto`;
      }
    }
    
    function setCursor(element, force = false) {
      if (!element || element === document) return;
      
      if (!force && element.dataset.cursorSet === 'true') return;
      
      const cursorValue = getCursorForElement(element);
      element.style.setProperty('cursor', cursorValue, 'important');
      element.dataset.cursorSet = 'true';
    }
    
    function applyCursorToAll() {
      // 設置body和html
      document.documentElement.style.setProperty('cursor', `url('${cursorArrow}') 0 0, url('${cursorHand}') 0 0, auto`, 'important');
      document.body.style.setProperty('cursor', `url('${cursorArrow}') 0 0, url('${cursorHand}') 0 0, auto`, 'important');
      
      // 設置所有元素
      const allElements = document.querySelectorAll('*');
      allElements.forEach(el => setCursor(el));
    }
    
    // 全局鼠標移動事件，強制設置游標
    let lastElement = null;
    function handleMouseMove(e) {
      const target = e.target;
      if (target !== lastElement) {
        lastElement = target;
        // 強制更新當前元素及其父元素的游標
        let current = target;
        while (current && current !== document.body) {
          setCursor(current, true);
          current = current.parentElement;
        }
        // 也更新body和html
        setCursor(document.body, true);
        setCursor(document.documentElement, true);
      }
    }
    
    // 鼠標進入事件
    function handleMouseEnter(e) {
      setCursor(e.target, true);
    }
    
    // 鼠標離開事件
    function handleMouseLeave(e) {
      // 設置下一個目標元素（如果有的話）
      if (e.relatedTarget) {
        setCursor(e.relatedTarget, true);
      }
    }
    
    // 點擊事件後強制設置
    function handleClick(e) {
      // 異步設置游標，避免干擾 React 的事件處理
      setTimeout(() => {
        setCursor(e.target, true);
      }, 0);
    }
    
    // 右鍵菜單事件
    function handleContextMenu(e) {
      e.preventDefault(); // 可選：阻止默認右鍵菜單
      setCursor(e.target, true);
      // 確保在右鍵菜單關閉後也設置游標
      setTimeout(() => {
        const element = document.elementFromPoint(e.clientX, e.clientY);
        if (element) {
          setCursor(element, true);
        }
      }, 10);
    }
    
    // 頁面加載時設置
    function initCursor() {
      applyCursorToAll();
      
      // 添加全局事件監聽器
      document.addEventListener('mousemove', handleMouseMove, true); // 使用捕獲階段
      document.addEventListener('mouseenter', handleMouseEnter, true);
      document.addEventListener('mouseleave', handleMouseLeave, true);
      // 使用冒泡階段處理點擊事件，避免干擾 React 的合成事件系統
      document.addEventListener('click', handleClick, false);
      document.addEventListener('contextmenu', handleContextMenu, true);
      document.addEventListener('mousedown', handleClick, false);
      document.addEventListener('mouseup', handleClick, false);
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initCursor);
    } else {
      initCursor();
    }
    
    // 監聽DOM變化，為新添加的元素設置游標
    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        mutation.addedNodes.forEach((node) => {
          if (node.nodeType === 1) { // Element node
            setCursor(node, true);
            // 也為子元素設置
            if (node.querySelectorAll) {
              node.querySelectorAll('*').forEach(el => setCursor(el, true));
            }
          }
        });
      });
    });
    
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
    
    // 更頻繁地檢查並修復游標（作為備用方案）
    setInterval(() => {
      const allElements = document.querySelectorAll('*');
      allElements.forEach((el) => {
        const style = window.getComputedStyle(el);
        const cursor = style.cursor;
        // 檢查是否是默認游標或沒有包含自定義游標
        if (cursor === 'auto' || cursor === 'default' || 
            (!cursor.includes('arrow.png') && !cursor.includes('hand.png') && 
             cursor !== 'pointer' && cursor !== 'text' && cursor !== 'grab' && cursor !== 'grabbing')) {
          setCursor(el, true);
        }
      });
      // 也確保body和html始終有游標
      setCursor(document.body, true);
      setCursor(document.documentElement, true);
    }, 100); // 更頻繁的檢查（每100ms）
  </script>
</body>
</html>
